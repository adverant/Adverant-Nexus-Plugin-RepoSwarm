apiVersion: v1
kind: Secret
metadata:
  name: nexus-reposwarm-secrets
  namespace: nexus
  labels:
    app: nexus-reposwarm
    app.kubernetes.io/name: nexus-reposwarm
    app.kubernetes.io/component: secrets
type: Opaque
stringData:
  # GitHub Personal Access Token for private repo access
  # Generate at: https://github.com/settings/tokens
  # Required scopes: repo (for private repos)
  github-token: ""

  # GitLab Personal Access Token for private repo access
  # Generate at: https://gitlab.com/-/profile/personal_access_tokens
  # Required scopes: read_repository
  gitlab-token: ""

  # Bitbucket App Password for private repo access
  # Generate at: https://bitbucket.org/account/settings/app-passwords/
  # Required permissions: Repositories (Read)
  bitbucket-token: ""

  # Webhook signing secret (auto-generated if not provided)
  webhook-secret: ""
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: nexus-reposwarm-config
  namespace: nexus
  labels:
    app: nexus-reposwarm
    app.kubernetes.io/name: nexus-reposwarm
    app.kubernetes.io/component: config
data:
  # Service configuration
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"

  # Analysis defaults
  DEFAULT_ANALYSIS_DEPTH: "standard"
  DEFAULT_CACHE_TTL_DAYS: "7"
  MAX_REPO_SIZE_MB: "500"
  MAX_FILES_PER_ANALYSIS: "5000"

  # Rate limiting
  RATE_LIMIT_REQUESTS_PER_MINUTE: "60"
  RATE_LIMIT_ANALYSIS_PER_HOUR: "10"

  # Monitoring defaults
  DEFAULT_POLL_INTERVAL_HOURS: "24"
  MAX_MONITORS_PER_USER: "25"

  # Webhook configuration
  WEBHOOK_TIMEOUT_MS: "30000"
  WEBHOOK_MAX_RETRIES: "3"
  WEBHOOK_RETRY_DELAY_MS: "60000"

  # Worker configuration
  WORKER_CONCURRENCY: "3"
  WORKER_MAX_RUNTIME_MS: "300000"
